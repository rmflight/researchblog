{
  "hash": "8a552a8386a944650d73dfa09f81700a",
  "result": {
    "markdown": "---\ntitle: \"Things I Learned About distill\"\nsubtitle: |\n  The various things I learned about the distill blog setup while converting posts over from my old blogdown site.\ndate: 02-28-2021\ncategories: [distill, blogdown, rmarkdown]\n---\n\n\n\n## Converting From Blogdown\n\nSo I converted this site to use [distill](https://blog.rstudio.com/2020/12/07/distill/) from my previous [blogdown](https://bookdown.org/yihui/blogdown/) site.\nThis involved a bit of a learning curve to get things right.\nAnd my blogdown site was pretty old, as in the default in blogdown at the time was for each post to be it's own file, not it's own directory, and the theme I used was the Academic theme (which has since changed names and I believe gotten more complicated).\nThis is not to knock on blogdown and Yihui (and other's) work in this area.\ndistill just felt like a better fit.\nHopefully I'm right.\nAnd hopefully this will be the last time I change where posts are located (yes, I'm still not using Netlify, so I still don't have redirects ...), because I wanted to use the date-title format, and I didn't keep the [slug] of the old YAML.\nI could have, but I wanted post locations to make sense across the site.\n\nSo I first used {blogdown} to convert my old blog directory to a bundled version using `blogdown::bundle_site()`.\nI then wrote a script to create the new directories based on the bundled ones, and then copy the old `index.Rmd` to the new direcotry with the proper name.\nI also decided I wanted to add a `refs.bib` to each directory so there was no friction in setting up references.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew_post_dir = \"~/Projects/personal/researchBlog_distill/_posts\"\nold_post_dir = \"~/Projects/personal/researchBlog_blogdown_convertFolders-bundle/content/post\"\n\nold_posts = dir(old_post_dir, full.names = TRUE, recursive = FALSE)\n\nold_properties = file.info(old_posts)\n\nkeep_old = old_posts[old_properties$isdir]\n\nnew_posts = dir(new_post_dir)\n\nkeep_old = keep_old[!(basename(keep_old) %in% new_posts)]\n\npurrr::walk(keep_old, function(in_dir){\n  new_loc = file.path(new_post_dir, basename(in_dir))\n  dir.create(new_loc)\n  index_loc = file.path(in_dir, \"index.Rmd\")\n  split_name = strsplit(basename(new_loc), \"-\", fixed = TRUE)[[1]]\n  split_name = split_name[seq(4, length(split_name))]\n  new_index = file.path(new_loc, paste0(paste(split_name, collapse = \"-\"), \".Rmd\"))\n  file.copy(index_loc, new_index)\n})\n\nnew_posts2 = dir(new_post_dir, full.names = TRUE)\npurrr::walk(new_posts2, function(in_dir){\n  file.create(file.path(in_dir, \"refs.bib\"))\n})\n```\n:::\n\n\nAs I figured out what extra I needed (see some of the sections below) in the YAML, I opened up each post, modified the categories as necessary, and then copied in the extra bits of YAML containing a mock description and the rest regarding TOC and code highlighting.\n\n## Descriptions: Do or Do Not, but Be Consistent\n\n`distill` has these nice descriptions that are displayed on the index page.\nHowever, if you render the site and some posts have descriptions and some don't, you will get a really, really weird error about `ETL text` or something.\nWhat to do, is if you have some posts with and without descriptions, is add to the ones without (having an empty description is fine), and then delete the XML files in your output director (default is `_site`) directory, and re-knit the posts and rebuild the site.\nHopefully that makes the error go away.\n\n## Theming can be a bit of a pain\n\nOK, I brought this on myself, I admit.\nI **really, really like** dark themes. \nI know I could just leave it white, and keep using the excellent [deluminate](https://deluminate.github.io/) extension to keep things dark, but I believe if I like a dark website, then my actual website should be dark too.\nI had to modify a lot of *divs* to make my site look nice (you can see the theme [here](https://github.com/rmflight/researchBlog_distill/blob/main/rmflight.css)).\nToo many.\n\n## Table of contents doesn't seem to be site-wide\n\nIncluding table of contents in the yaml of `_site.yml` doesn't make them magically appear on every page.\nYou have to set them on each post.\nTherefore, you decide before you render the post.\n\n## Utterances was easy!\n\nThanks to [Miles McBain](https://milesmcbain.micro.blog/2020/09/04/how-i-got.html), getting the Utterances comment framework in was easy-peasy!\nAnd it's something you can add after the fact, because it's done as an [HTML include](https://github.com/MilesMcBain/milesmcbain.com/blob/master/utterances.html) and a simple addition to your `_site.yml`.\n\n```\noutput:\n  distill::distill_article:\n    includes:\n      in_header: utterances.html\n```\n\nTo check if it is working, you will need to `serve` the site using `servr::httd(\"site_dir\")` though, you can't just open the html pages and look.\n\n## Search is awesome!\n\nHaving search on the website is soooo nice!\nAnd it searches the descriptions, so as long as you write something useful in the description, it will actually work.\nAgain, testing it requires `servr::httd()`.\n\n## Highlighting must be set on each article\n\nIf I set the code highlight theme in `_site.yml`, it doesn't seem to work.\n\n## Adding Images\n\nIt took some reading to figure out I should be using `knitr::include_graphics()` to have images into my blog posts.\nFrom what I can tell, I should have been using this long ago.\n\n## Citations, Footnotes, Asides\n\nThese are all really cool features that I want to use waaaayyy more in my posts.\nI started converting some of my posts to use them (see my code above that created refs.bib files in all of the post directories), and realized if I did that I'd never get the updated blog posted.\nSo expect to see more of those things in *new* posts, and maybe as I get time (hah!) I'll convert some older ones over.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}